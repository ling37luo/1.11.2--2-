ARM GAS  C:\Users\wxwsyzh\AppData\Local\Temp\ccazXLng.s 			page 1


   1              		.cpu cortex-m4
   2              		.arch armv7e-m
   3              		.fpu fpv4-sp-d16
   4              		.eabi_attribute 27, 1
   5              		.eabi_attribute 28, 1
   6              		.eabi_attribute 20, 1
   7              		.eabi_attribute 21, 1
   8              		.eabi_attribute 23, 3
   9              		.eabi_attribute 24, 1
  10              		.eabi_attribute 25, 1
  11              		.eabi_attribute 26, 1
  12              		.eabi_attribute 30, 1
  13              		.eabi_attribute 34, 1
  14              		.eabi_attribute 18, 4
  15              		.file	"motor_control.c"
  16              		.text
  17              	.Ltext0:
  18              		.cfi_sections	.debug_frame
  19              		.file 1 "App/Src/motor_control.c"
  20              		.section	.text.Motor_Process_Angle,"ax",%progbits
  21              		.align	1
  22              		.syntax unified
  23              		.thumb
  24              		.thumb_func
  26              	Motor_Process_Angle:
  27              	.LVL0:
  28              	.LFB134:
   1:App/Src/motor_control.c **** #include "motor_control.h"
   2:App/Src/motor_control.c **** #include "can_bsp.h"
   3:App/Src/motor_control.c **** #include <math.h>
   4:App/Src/motor_control.c **** 
   5:App/Src/motor_control.c **** GM6020_TypeDef gm6020_motors[4];
   6:App/Src/motor_control.c **** int16_t motor_current_send_buf[4]; // 添加发送缓冲区定义
   7:App/Src/motor_control.c **** 
   8:App/Src/motor_control.c **** #define PI 3.1415926535f
   9:App/Src/motor_control.c **** 
  10:App/Src/motor_control.c **** /**
  11:App/Src/motor_control.c ****  * @brief 角度处理
  12:App/Src/motor_control.c ****  */
  13:App/Src/motor_control.c **** static void Motor_Process_Angle(GM6020_TypeDef *motor) {
  29              		.loc 1 13 56 view -0
  30              		.cfi_startproc
  31              		@ args = 0, pretend = 0, frame = 0
  32              		@ frame_needed = 0, uses_anonymous_args = 0
  33              		@ link register save eliminated.
  14:App/Src/motor_control.c ****     int diff = motor->ecd_raw - motor->last_ecd;
  34              		.loc 1 14 5 view .LVU1
  35              		.loc 1 14 21 is_stmt 0 view .LVU2
  36 0000 4288     		ldrh	r2, [r0, #2]
  37              		.loc 1 14 38 view .LVU3
  38 0002 8388     		ldrh	r3, [r0, #4]
  39              		.loc 1 14 9 view .LVU4
  40 0004 D31A     		subs	r3, r2, r3
  41              	.LVL1:
  15:App/Src/motor_control.c ****     if (diff > 4096) motor->round_cnt--;
  42              		.loc 1 15 5 is_stmt 1 view .LVU5
  43              		.loc 1 15 8 is_stmt 0 view .LVU6
ARM GAS  C:\Users\wxwsyzh\AppData\Local\Temp\ccazXLng.s 			page 2


  44 0006 B3F5805F 		cmp	r3, #4096
  45 000a 1ADD     		ble	.L2
  46              		.loc 1 15 22 is_stmt 1 discriminator 1 view .LVU7
  47              		.loc 1 15 27 is_stmt 0 discriminator 1 view .LVU8
  48 000c C368     		ldr	r3, [r0, #12]
  49              	.LVL2:
  50              		.loc 1 15 38 discriminator 1 view .LVU9
  51 000e 013B     		subs	r3, r3, #1
  52 0010 C360     		str	r3, [r0, #12]
  53              	.L3:
  16:App/Src/motor_control.c ****     else if (diff < -4096) motor->round_cnt++;
  17:App/Src/motor_control.c ****     motor->total_angle = motor->round_cnt * 360.0f + (motor->ecd_raw / 8192.0f * 360.0f);
  54              		.loc 1 17 5 is_stmt 1 view .LVU10
  55              		.loc 1 17 43 is_stmt 0 view .LVU11
  56 0012 D0ED037A 		vldr.32	s15, [r0, #12]	@ int
  57 0016 F8EEE77A 		vcvt.f32.s32	s15, s15
  58 001a DFED0D6A 		vldr.32	s13, .L4
  59 001e 67EEA67A 		vmul.f32	s15, s15, s13
  60              		.loc 1 17 70 view .LVU12
  61 0022 07EE102A 		vmov	s14, r2	@ int
  62 0026 B8EEC77A 		vcvt.f32.s32	s14, s14
  63 002a 9FED0A6A 		vldr.32	s12, .L4+4
  64 002e 27EE067A 		vmul.f32	s14, s14, s12
  65              		.loc 1 17 80 view .LVU13
  66 0032 27EE267A 		vmul.f32	s14, s14, s13
  67              		.loc 1 17 52 view .LVU14
  68 0036 77EE877A 		vadd.f32	s15, s15, s14
  69              		.loc 1 17 24 view .LVU15
  70 003a C0ED047A 		vstr.32	s15, [r0, #16]
  18:App/Src/motor_control.c ****     motor->last_ecd = motor->ecd_raw;
  71              		.loc 1 18 5 is_stmt 1 view .LVU16
  72              		.loc 1 18 21 is_stmt 0 view .LVU17
  73 003e 8280     		strh	r2, [r0, #4]	@ movhi
  74              	.LVL3:
  19:App/Src/motor_control.c **** }
  75              		.loc 1 19 1 view .LVU18
  76 0040 7047     		bx	lr
  77              	.LVL4:
  78              	.L2:
  16:App/Src/motor_control.c ****     else if (diff < -4096) motor->round_cnt++;
  79              		.loc 1 16 10 is_stmt 1 view .LVU19
  16:App/Src/motor_control.c ****     else if (diff < -4096) motor->round_cnt++;
  80              		.loc 1 16 13 is_stmt 0 view .LVU20
  81 0042 13F5805F 		cmn	r3, #4096
  82 0046 E4DA     		bge	.L3
  16:App/Src/motor_control.c ****     else if (diff < -4096) motor->round_cnt++;
  83              		.loc 1 16 28 is_stmt 1 discriminator 1 view .LVU21
  16:App/Src/motor_control.c ****     else if (diff < -4096) motor->round_cnt++;
  84              		.loc 1 16 33 is_stmt 0 discriminator 1 view .LVU22
  85 0048 C368     		ldr	r3, [r0, #12]
  86              	.LVL5:
  16:App/Src/motor_control.c ****     else if (diff < -4096) motor->round_cnt++;
  87              		.loc 1 16 44 discriminator 1 view .LVU23
  88 004a 0133     		adds	r3, r3, #1
  89 004c C360     		str	r3, [r0, #12]
  90 004e E0E7     		b	.L3
  91              	.L5:
ARM GAS  C:\Users\wxwsyzh\AppData\Local\Temp\ccazXLng.s 			page 3


  92              		.align	2
  93              	.L4:
  94 0050 0000B443 		.word	1135869952
  95 0054 00000039 		.word	956301312
  96              		.cfi_endproc
  97              	.LFE134:
  99              		.section	.text.limit_current,"ax",%progbits
 100              		.align	1
 101              		.syntax unified
 102              		.thumb
 103              		.thumb_func
 105              	limit_current:
 106              	.LVL6:
 107              	.LFB136:
  20:App/Src/motor_control.c **** 
  21:App/Src/motor_control.c **** /**
  22:App/Src/motor_control.c ****  * @brief 计算重力前馈
  23:App/Src/motor_control.c ****  */
  24:App/Src/motor_control.c **** static int16_t Motor_Calc_Gravity_FF(GM6020_TypeDef *motor) {
  25:App/Src/motor_control.c ****     if (motor->id == 4) {
  26:App/Src/motor_control.c ****         return 0;
  27:App/Src/motor_control.c ****     }
  28:App/Src/motor_control.c ****     int32_t ecd_diff = motor->ecd_raw - motor->horizon_ecd;
  29:App/Src/motor_control.c ****     
  30:App/Src/motor_control.c ****     if (ecd_diff > 4096)  ecd_diff -= 8192;
  31:App/Src/motor_control.c ****     if (ecd_diff < -4096) ecd_diff += 8192;
  32:App/Src/motor_control.c **** 
  33:App/Src/motor_control.c ****     float angle_rad = (float)ecd_diff * (2.0f * PI / 8192.0f);
  34:App/Src/motor_control.c ****     return (int16_t)(motor->gravity_gain * cosf(angle_rad));
  35:App/Src/motor_control.c **** }
  36:App/Src/motor_control.c **** 
  37:App/Src/motor_control.c **** // 辅助函数：限制电流范围
  38:App/Src/motor_control.c **** static int16_t limit_current(float val) {
 108              		.loc 1 38 41 is_stmt 1 view -0
 109              		.cfi_startproc
 110              		@ args = 0, pretend = 0, frame = 0
 111              		@ frame_needed = 0, uses_anonymous_args = 0
 112              		@ link register save eliminated.
  39:App/Src/motor_control.c ****     if (val > GM6020_MAX_CURRENT) return (int16_t)GM6020_MAX_CURRENT;
 113              		.loc 1 39 5 view .LVU25
 114              		.loc 1 39 8 is_stmt 0 view .LVU26
 115 0000 DFED0C7A 		vldr.32	s15, .L10
 116 0004 B4EEE70A 		vcmpe.f32	s0, s15
 117 0008 F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 118 000c 0CDC     		bgt	.L8
  40:App/Src/motor_control.c ****     if (val < -GM6020_MAX_CURRENT) return (int16_t)-GM6020_MAX_CURRENT;
 119              		.loc 1 40 5 is_stmt 1 view .LVU27
 120              		.loc 1 40 8 is_stmt 0 view .LVU28
 121 000e DFED0A7A 		vldr.32	s15, .L10+4
 122 0012 B4EEE70A 		vcmpe.f32	s0, s15
 123 0016 F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 124 001a 08D4     		bmi	.L9
  41:App/Src/motor_control.c ****     return (int16_t)val;
 125              		.loc 1 41 5 is_stmt 1 view .LVU29
 126              		.loc 1 41 12 is_stmt 0 view .LVU30
 127 001c BDEEC00A 		vcvt.s32.f32	s0, s0
 128              	.LVL7:
ARM GAS  C:\Users\wxwsyzh\AppData\Local\Temp\ccazXLng.s 			page 4


 129              		.loc 1 41 12 view .LVU31
 130 0020 10EE103A 		vmov	r3, s0	@ int
 131 0024 18B2     		sxth	r0, r3
 132 0026 7047     		bx	lr
 133              	.LVL8:
 134              	.L8:
  39:App/Src/motor_control.c ****     if (val > GM6020_MAX_CURRENT) return (int16_t)GM6020_MAX_CURRENT;
 135              		.loc 1 39 42 discriminator 1 view .LVU32
 136 0028 4FF48040 		mov	r0, #16384
 137 002c 7047     		bx	lr
 138              	.L9:
  40:App/Src/motor_control.c ****     if (val < -GM6020_MAX_CURRENT) return (int16_t)-GM6020_MAX_CURRENT;
 139              		.loc 1 40 43 discriminator 1 view .LVU33
 140 002e 0348     		ldr	r0, .L10+8
  42:App/Src/motor_control.c **** }
 141              		.loc 1 42 1 view .LVU34
 142 0030 7047     		bx	lr
 143              	.L11:
 144 0032 00BF     		.align	2
 145              	.L10:
 146 0034 00008046 		.word	1182793728
 147 0038 000080C6 		.word	-964689920
 148 003c 00C0FFFF 		.word	-16384
 149              		.cfi_endproc
 150              	.LFE136:
 152              		.section	.text.Motor_Check_Stall,"ax",%progbits
 153              		.align	1
 154              		.syntax unified
 155              		.thumb
 156              		.thumb_func
 158              	Motor_Check_Stall:
 159              	.LVL9:
 160              	.LFB137:
  43:App/Src/motor_control.c **** 
  44:App/Src/motor_control.c **** /**
  45:App/Src/motor_control.c ****  * @brief 堵转检测逻辑 (只保留一个定义)
  46:App/Src/motor_control.c ****  */
  47:App/Src/motor_control.c **** static void Motor_Check_Stall(GM6020_TypeDef *motor) {
 161              		.loc 1 47 54 is_stmt 1 view -0
 162              		.cfi_startproc
 163              		@ args = 0, pretend = 0, frame = 0
 164              		@ frame_needed = 0, uses_anonymous_args = 0
 165              		@ link register save eliminated.
  48:App/Src/motor_control.c ****     if (motor->mode == MOTOR_MODE_STOP || motor->is_stalled) return;
 166              		.loc 1 48 5 view .LVU36
 167              		.loc 1 48 14 is_stmt 0 view .LVU37
 168 0000 4378     		ldrb	r3, [r0, #1]	@ zero_extendqisi2
 169              		.loc 1 48 8 view .LVU38
 170 0002 032B     		cmp	r3, #3
 171 0004 32D0     		beq	.L12
 172              		.loc 1 48 48 discriminator 2 view .LVU39
 173 0006 90F8EC30 		ldrb	r3, [r0, #236]	@ zero_extendqisi2
 174              		.loc 1 48 40 discriminator 2 view .LVU40
 175 000a 7BBB     		cbnz	r3, .L12
  49:App/Src/motor_control.c **** 
  50:App/Src/motor_control.c ****     if (fabsf(motor->output_current) > STALL_CURRENT_THRESH && 
 176              		.loc 1 50 5 is_stmt 1 view .LVU41
ARM GAS  C:\Users\wxwsyzh\AppData\Local\Temp\ccazXLng.s 			page 5


 177              		.loc 1 50 20 is_stmt 0 view .LVU42
 178 000c B0F9E430 		ldrsh	r3, [r0, #228]
 179 0010 07EE903A 		vmov	s15, r3	@ int
 180              		.loc 1 50 9 view .LVU43
 181 0014 F8EEE77A 		vcvt.f32.s32	s15, s15
 182 0018 F0EEE77A 		vabs.f32	s15, s15
 183              		.loc 1 50 8 view .LVU44
 184 001c 9FED147A 		vldr.32	s14, .L19
 185 0020 F4EEC77A 		vcmpe.f32	s15, s14
 186 0024 F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 187 0028 1DDD     		ble	.L14
  51:App/Src/motor_control.c ****         fabsf(motor->speed_rpm) < STALL_SPEED_THRESH) {
 188              		.loc 1 51 20 view .LVU45
 189 002a B0F90630 		ldrsh	r3, [r0, #6]
 190 002e 07EE903A 		vmov	s15, r3	@ int
 191              		.loc 1 51 9 view .LVU46
 192 0032 F8EEE77A 		vcvt.f32.s32	s15, s15
 193 0036 F0EEE77A 		vabs.f32	s15, s15
  50:App/Src/motor_control.c ****         fabsf(motor->speed_rpm) < STALL_SPEED_THRESH) {
 194              		.loc 1 50 61 discriminator 1 view .LVU47
 195 003a 9FED0E7A 		vldr.32	s14, .L19+4
 196 003e F4EEC77A 		vcmpe.f32	s15, s14
 197 0042 F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 198 0046 0ED5     		bpl	.L14
  52:App/Src/motor_control.c ****         
  53:App/Src/motor_control.c ****         motor->stall_cnt++;
 199              		.loc 1 53 9 is_stmt 1 view .LVU48
 200              		.loc 1 53 14 is_stmt 0 view .LVU49
 201 0048 D0F8E830 		ldr	r3, [r0, #232]
 202              		.loc 1 53 25 view .LVU50
 203 004c 0133     		adds	r3, r3, #1
 204 004e C0F8E830 		str	r3, [r0, #232]
  54:App/Src/motor_control.c ****         if (motor->stall_cnt > STALL_TIME_MS) {
 205              		.loc 1 54 9 is_stmt 1 view .LVU51
 206              		.loc 1 54 12 is_stmt 0 view .LVU52
 207 0052 40F2DC52 		movw	r2, #1500
 208 0056 9342     		cmp	r3, r2
 209 0058 08D9     		bls	.L12
  55:App/Src/motor_control.c ****             motor->is_stalled = 1;
 210              		.loc 1 55 13 is_stmt 1 view .LVU53
 211              		.loc 1 55 31 is_stmt 0 view .LVU54
 212 005a 0123     		movs	r3, #1
 213 005c 80F8EC30 		strb	r3, [r0, #236]
  56:App/Src/motor_control.c ****             motor->mode = MOTOR_MODE_STOP;
 214              		.loc 1 56 13 is_stmt 1 view .LVU55
 215              		.loc 1 56 25 is_stmt 0 view .LVU56
 216 0060 0323     		movs	r3, #3
 217 0062 4370     		strb	r3, [r0, #1]
 218 0064 7047     		bx	lr
 219              	.L14:
  57:App/Src/motor_control.c ****         }
  58:App/Src/motor_control.c ****     } else {
  59:App/Src/motor_control.c ****         motor->stall_cnt = 0;
 220              		.loc 1 59 9 is_stmt 1 view .LVU57
 221              		.loc 1 59 26 is_stmt 0 view .LVU58
 222 0066 0023     		movs	r3, #0
 223 0068 C0F8E830 		str	r3, [r0, #232]
ARM GAS  C:\Users\wxwsyzh\AppData\Local\Temp\ccazXLng.s 			page 6


 224              	.L12:
  60:App/Src/motor_control.c ****     }
  61:App/Src/motor_control.c **** }
 225              		.loc 1 61 1 view .LVU59
 226 006c 7047     		bx	lr
 227              	.L20:
 228 006e 00BF     		.align	2
 229              	.L19:
 230 0070 00803B46 		.word	1178304512
 231 0074 0000C842 		.word	1120403456
 232              		.cfi_endproc
 233              	.LFE137:
 235              		.section	.text.Motor_Calc_Gravity_FF,"ax",%progbits
 236              		.align	1
 237              		.syntax unified
 238              		.thumb
 239              		.thumb_func
 241              	Motor_Calc_Gravity_FF:
 242              	.LVL10:
 243              	.LFB135:
  24:App/Src/motor_control.c ****     if (motor->id == 4) {
 244              		.loc 1 24 61 is_stmt 1 view -0
 245              		.cfi_startproc
 246              		@ args = 0, pretend = 0, frame = 0
 247              		@ frame_needed = 0, uses_anonymous_args = 0
  24:App/Src/motor_control.c ****     if (motor->id == 4) {
 248              		.loc 1 24 61 is_stmt 0 view .LVU61
 249 0000 08B5     		push	{r3, lr}
 250              	.LCFI0:
 251              		.cfi_def_cfa_offset 8
 252              		.cfi_offset 3, -8
 253              		.cfi_offset 14, -4
 254 0002 2DED028B 		vpush.64	{d8}
 255              	.LCFI1:
 256              		.cfi_def_cfa_offset 16
 257              		.cfi_offset 80, -16
 258              		.cfi_offset 81, -12
  25:App/Src/motor_control.c ****         return 0;
 259              		.loc 1 25 5 is_stmt 1 view .LVU62
  25:App/Src/motor_control.c ****         return 0;
 260              		.loc 1 25 14 is_stmt 0 view .LVU63
 261 0006 0378     		ldrb	r3, [r0]	@ zero_extendqisi2
  25:App/Src/motor_control.c ****         return 0;
 262              		.loc 1 25 8 view .LVU64
 263 0008 042B     		cmp	r3, #4
 264 000a 24D0     		beq	.L25
  28:App/Src/motor_control.c ****     
 265              		.loc 1 28 5 is_stmt 1 view .LVU65
  28:App/Src/motor_control.c ****     
 266              		.loc 1 28 29 is_stmt 0 view .LVU66
 267 000c 4388     		ldrh	r3, [r0, #2]
  28:App/Src/motor_control.c ****     
 268              		.loc 1 28 46 view .LVU67
 269 000e B0F8EE20 		ldrh	r2, [r0, #238]
  28:App/Src/motor_control.c ****     
 270              		.loc 1 28 13 view .LVU68
 271 0012 9B1A     		subs	r3, r3, r2
ARM GAS  C:\Users\wxwsyzh\AppData\Local\Temp\ccazXLng.s 			page 7


 272              	.LVL11:
  30:App/Src/motor_control.c ****     if (ecd_diff < -4096) ecd_diff += 8192;
 273              		.loc 1 30 5 is_stmt 1 view .LVU69
  30:App/Src/motor_control.c ****     if (ecd_diff < -4096) ecd_diff += 8192;
 274              		.loc 1 30 8 is_stmt 0 view .LVU70
 275 0014 B3F5805F 		cmp	r3, #4096
 276 0018 17DD     		ble	.L23
  30:App/Src/motor_control.c ****     if (ecd_diff < -4096) ecd_diff += 8192;
 277              		.loc 1 30 27 is_stmt 1 discriminator 1 view .LVU71
  30:App/Src/motor_control.c ****     if (ecd_diff < -4096) ecd_diff += 8192;
 278              		.loc 1 30 36 is_stmt 0 discriminator 1 view .LVU72
 279 001a A3F50053 		sub	r3, r3, #8192
 280              	.LVL12:
  31:App/Src/motor_control.c **** 
 281              		.loc 1 31 5 is_stmt 1 view .LVU73
 282              	.L24:
  33:App/Src/motor_control.c ****     return (int16_t)(motor->gravity_gain * cosf(angle_rad));
 283              		.loc 1 33 5 view .LVU74
  33:App/Src/motor_control.c ****     return (int16_t)(motor->gravity_gain * cosf(angle_rad));
 284              		.loc 1 33 23 is_stmt 0 view .LVU75
 285 001e 07EE903A 		vmov	s15, r3	@ int
 286 0022 F8EEE77A 		vcvt.f32.s32	s15, s15
 287              	.LVL13:
  34:App/Src/motor_control.c **** }
 288              		.loc 1 34 5 is_stmt 1 view .LVU76
  34:App/Src/motor_control.c **** }
 289              		.loc 1 34 27 is_stmt 0 view .LVU77
 290 0026 90ED3C8A 		vldr.32	s16, [r0, #240]
  34:App/Src/motor_control.c **** }
 291              		.loc 1 34 44 view .LVU78
 292 002a 9FED0C0A 		vldr.32	s0, .L27
 293 002e 27EE800A 		vmul.f32	s0, s15, s0
 294              	.LVL14:
  34:App/Src/motor_control.c **** }
 295              		.loc 1 34 44 view .LVU79
 296 0032 FFF7FEFF 		bl	cosf
 297              	.LVL15:
  34:App/Src/motor_control.c **** }
 298              		.loc 1 34 42 discriminator 1 view .LVU80
 299 0036 28EE008A 		vmul.f32	s16, s16, s0
  34:App/Src/motor_control.c **** }
 300              		.loc 1 34 12 discriminator 1 view .LVU81
 301 003a BDEEC88A 		vcvt.s32.f32	s16, s16
 302 003e 18EE103A 		vmov	r3, s16	@ int
 303 0042 18B2     		sxth	r0, r3
 304              	.LVL16:
 305              	.L22:
  35:App/Src/motor_control.c **** 
 306              		.loc 1 35 1 view .LVU82
 307 0044 BDEC028B 		vldm	sp!, {d8}
 308              	.LCFI2:
 309              		.cfi_remember_state
 310              		.cfi_restore 80
 311              		.cfi_restore 81
 312              		.cfi_def_cfa_offset 8
 313 0048 08BD     		pop	{r3, pc}
 314              	.LVL17:
ARM GAS  C:\Users\wxwsyzh\AppData\Local\Temp\ccazXLng.s 			page 8


 315              	.L23:
 316              	.LCFI3:
 317              		.cfi_restore_state
  31:App/Src/motor_control.c **** 
 318              		.loc 1 31 5 is_stmt 1 view .LVU83
  31:App/Src/motor_control.c **** 
 319              		.loc 1 31 8 is_stmt 0 view .LVU84
 320 004a 13F5805F 		cmn	r3, #4096
 321 004e E6DA     		bge	.L24
  31:App/Src/motor_control.c **** 
 322              		.loc 1 31 27 is_stmt 1 discriminator 1 view .LVU85
  31:App/Src/motor_control.c **** 
 323              		.loc 1 31 36 is_stmt 0 discriminator 1 view .LVU86
 324 0050 03F50053 		add	r3, r3, #8192
 325              	.LVL18:
  31:App/Src/motor_control.c **** 
 326              		.loc 1 31 36 discriminator 1 view .LVU87
 327 0054 E3E7     		b	.L24
 328              	.LVL19:
 329              	.L25:
  26:App/Src/motor_control.c ****     }
 330              		.loc 1 26 16 view .LVU88
 331 0056 0020     		movs	r0, #0
 332              	.LVL20:
  26:App/Src/motor_control.c ****     }
 333              		.loc 1 26 16 view .LVU89
 334 0058 F4E7     		b	.L22
 335              	.L28:
 336 005a 00BF     		.align	2
 337              	.L27:
 338 005c DB0F493A 		.word	977866715
 339              		.cfi_endproc
 340              	.LFE135:
 342              		.section	.text.Motor_Clear_Stall,"ax",%progbits
 343              		.align	1
 344              		.global	Motor_Clear_Stall
 345              		.syntax unified
 346              		.thumb
 347              		.thumb_func
 349              	Motor_Clear_Stall:
 350              	.LVL21:
 351              	.LFB138:
  62:App/Src/motor_control.c **** 
  63:App/Src/motor_control.c **** // 清除堵转状态 (修复未使用变量警告)
  64:App/Src/motor_control.c **** void Motor_Clear_Stall(uint8_t id) {
 352              		.loc 1 64 36 is_stmt 1 view -0
 353              		.cfi_startproc
 354              		@ args = 0, pretend = 0, frame = 0
 355              		@ frame_needed = 0, uses_anonymous_args = 0
 356              		@ link register save eliminated.
  65:App/Src/motor_control.c ****     if (id < 1 || id > 4) return;
 357              		.loc 1 65 5 view .LVU91
 358              		.loc 1 65 16 is_stmt 0 view .LVU92
 359 0000 431E     		subs	r3, r0, #1
 360 0002 DBB2     		uxtb	r3, r3
 361              		.loc 1 65 8 view .LVU93
 362 0004 032B     		cmp	r3, #3
ARM GAS  C:\Users\wxwsyzh\AppData\Local\Temp\ccazXLng.s 			page 9


 363 0006 0FD8     		bhi	.L29
  66:App/Src/motor_control.c ****     // 直接使用数组，不需要中间变量
  67:App/Src/motor_control.c ****     gm6020_motors[id-1].is_stalled = 0;
 364              		.loc 1 67 5 is_stmt 1 view .LVU94
 365              		.loc 1 67 21 is_stmt 0 view .LVU95
 366 0008 0138     		subs	r0, r0, #1
 367              	.LVL22:
 368              		.loc 1 67 36 view .LVU96
 369 000a 084A     		ldr	r2, .L31
 370 000c C0EB4013 		rsb	r3, r0, r0, lsl #5
 371 0010 02EBC303 		add	r3, r2, r3, lsl #3
 372 0014 0021     		movs	r1, #0
 373 0016 83F8EC10 		strb	r1, [r3, #236]
  68:App/Src/motor_control.c ****     gm6020_motors[id-1].stall_cnt = 0;
 374              		.loc 1 68 5 is_stmt 1 view .LVU97
 375              		.loc 1 68 35 is_stmt 0 view .LVU98
 376 001a C3F8E810 		str	r1, [r3, #232]
  69:App/Src/motor_control.c ****     gm6020_motors[id-1].mode = MOTOR_MODE_CURRENT_SPEED;
 377              		.loc 1 69 5 is_stmt 1 view .LVU99
 378              		.loc 1 69 30 is_stmt 0 view .LVU100
 379 001e 0121     		movs	r1, #1
 380 0020 5970     		strb	r1, [r3, #1]
  70:App/Src/motor_control.c ****     gm6020_motors[id-1].target_val = 0;
 381              		.loc 1 70 5 is_stmt 1 view .LVU101
 382              		.loc 1 70 36 is_stmt 0 view .LVU102
 383 0022 1A46     		mov	r2, r3
 384 0024 0023     		movs	r3, #0
 385 0026 5361     		str	r3, [r2, #20]	@ float
 386              	.LVL23:
 387              	.L29:
  71:App/Src/motor_control.c **** }
 388              		.loc 1 71 1 view .LVU103
 389 0028 7047     		bx	lr
 390              	.L32:
 391 002a 00BF     		.align	2
 392              	.L31:
 393 002c 00000000 		.word	gm6020_motors
 394              		.cfi_endproc
 395              	.LFE138:
 397              		.section	.text.Motor_Init_All,"ax",%progbits
 398              		.align	1
 399              		.global	Motor_Init_All
 400              		.syntax unified
 401              		.thumb
 402              		.thumb_func
 404              	Motor_Init_All:
 405              	.LFB139:
  72:App/Src/motor_control.c **** 
  73:App/Src/motor_control.c **** void Motor_Init_All(void) {
 406              		.loc 1 73 27 is_stmt 1 view -0
 407              		.cfi_startproc
 408              		@ args = 0, pretend = 0, frame = 0
 409              		@ frame_needed = 0, uses_anonymous_args = 0
 410 0000 70B5     		push	{r4, r5, r6, lr}
 411              	.LCFI4:
 412              		.cfi_def_cfa_offset 16
 413              		.cfi_offset 4, -16
ARM GAS  C:\Users\wxwsyzh\AppData\Local\Temp\ccazXLng.s 			page 10


 414              		.cfi_offset 5, -12
 415              		.cfi_offset 6, -8
 416              		.cfi_offset 14, -4
 417 0002 2DED028B 		vpush.64	{d8}
 418              	.LCFI5:
 419              		.cfi_def_cfa_offset 24
 420              		.cfi_offset 80, -24
 421              		.cfi_offset 81, -20
  74:App/Src/motor_control.c ****     for (int i = 0; i < 4; i++) {
 422              		.loc 1 74 5 view .LVU105
 423              	.LBB2:
 424              		.loc 1 74 10 view .LVU106
 425              	.LVL24:
 426              		.loc 1 74 14 is_stmt 0 view .LVU107
 427 0006 0024     		movs	r4, #0
 428              		.loc 1 74 5 view .LVU108
 429 0008 3EE0     		b	.L34
 430              	.LVL25:
 431              	.L40:
 432              	.LBB3:
  75:App/Src/motor_control.c ****         gm6020_motors[i].id = i + 1;
  76:App/Src/motor_control.c ****         gm6020_motors[i].mode = MOTOR_MODE_CURRENT_SPEED;
  77:App/Src/motor_control.c ****         gm6020_motors[i].target_val = 0;
  78:App/Src/motor_control.c ****         gm6020_motors[i].round_cnt = 0;
  79:App/Src/motor_control.c ****         gm6020_motors[i].is_stalled = 0;
  80:App/Src/motor_control.c ****         gm6020_motors[i].last_ecd = 0;
  81:App/Src/motor_control.c ****         gm6020_motors[i].feedforward = 0;
  82:App/Src/motor_control.c ****         gm6020_motors[i].horizon_ecd = 4096;
  83:App/Src/motor_control.c ****         
  84:App/Src/motor_control.c ****         // 上电机特殊处理
  85:App/Src/motor_control.c ****         if (i == 3) { // ID=4
  86:App/Src/motor_control.c ****             gm6020_motors[i].gravity_gain = 0.0f;
 433              		.loc 1 86 13 is_stmt 1 view .LVU109
 434              		.loc 1 86 43 is_stmt 0 view .LVU110
 435 000a 0646     		mov	r6, r0
 436 000c 6501     		lsls	r5, r4, #5
 437 000e C4EB4412 		rsb	r2, r4, r4, lsl #5
 438 0012 D300     		lsls	r3, r2, #3
 439 0014 0344     		add	r3, r3, r0
 440 0016 9FED428A 		vldr.32	s16, .L41
 441 001a 83ED3C8A 		vstr.32	s16, [r3, #240]
  87:App/Src/motor_control.c ****         } else {
  88:App/Src/motor_control.c ****             gm6020_motors[i].gravity_gain = 0.0f;
  89:App/Src/motor_control.c ****         }
  90:App/Src/motor_control.c ****         
  91:App/Src/motor_control.c ****         float speed_dead_zone = 1.0f;
 442              		.loc 1 91 9 is_stmt 1 view .LVU111
 443              	.LVL26:
  92:App/Src/motor_control.c ****         float angle_dead_zone = 0.5f; 
 444              		.loc 1 92 9 view .LVU112
  93:App/Src/motor_control.c ****         
  94:App/Src/motor_control.c ****         // 优化PID参数（上电机）
  95:App/Src/motor_control.c ****         if (i == 3) { // ID=4
 445              		.loc 1 95 9 view .LVU113
  96:App/Src/motor_control.c ****             PID_Init(&gm6020_motors[i].speed_pid, 
 446              		.loc 1 96 13 view .LVU114
 447 001e D000     		lsls	r0, r2, #3
ARM GAS  C:\Users\wxwsyzh\AppData\Local\Temp\ccazXLng.s 			page 11


 448 0020 1830     		adds	r0, r0, #24
 449 0022 F7EE002A 		vmov.f32	s5, #1.0e+0
 450 0026 9FED3F2A 		vldr.32	s4, .L41+4
 451 002a DFED3F1A 		vldr.32	s3, .L41+8
 452 002e 9FED3F1A 		vldr.32	s2, .L41+12
 453 0032 F1EE040A 		vmov.f32	s1, #5.0e+0
 454 0036 9FED3E0A 		vldr.32	s0, .L41+16
 455 003a 3044     		add	r0, r0, r6
 456 003c FFF7FEFF 		bl	PID_Init
 457              	.LVL27:
  97:App/Src/motor_control.c ****                      140.0f,   // Kp
  98:App/Src/motor_control.c ****                      5.0f,     // Ki
  99:App/Src/motor_control.c ****                      0.1f,     // Kd
 100:App/Src/motor_control.c ****                      GM6020_MAX_CURRENT,
 101:App/Src/motor_control.c ****                      5000.0f,  // 积分限幅
 102:App/Src/motor_control.c ****                      speed_dead_zone);
 103:App/Src/motor_control.c ****             
 104:App/Src/motor_control.c ****             PID_Init(&gm6020_motors[i].angle_pid, 
 458              		.loc 1 104 13 view .LVU115
 459 0040 2B1B     		subs	r3, r5, r4
 460 0042 D800     		lsls	r0, r3, #3
 461 0044 5830     		adds	r0, r0, #88
 462 0046 3044     		add	r0, r0, r6
 463 0048 F6EE002A 		vmov.f32	s5, #5.0e-1
 464 004c B0EE482A 		vmov.f32	s4, s16
 465 0050 DFED381A 		vldr.32	s3, .L41+20
 466 0054 B0EE481A 		vmov.f32	s2, s16
 467 0058 F0EE480A 		vmov.f32	s1, s16
 468 005c B1EE0C0A 		vmov.f32	s0, #7.0e+0
 469 0060 0430     		adds	r0, r0, #4
 470 0062 FFF7FEFF 		bl	PID_Init
 471              	.LVL28:
 472              	.L36:
 105:App/Src/motor_control.c ****                      7.0f,     // Kp
 106:App/Src/motor_control.c ****                      0.0f,     
 107:App/Src/motor_control.c ****                      0.0f,
 108:App/Src/motor_control.c ****                      100.0f,   // MaxOut: 限制最大速度
 109:App/Src/motor_control.c ****                      0.0f,
 110:App/Src/motor_control.c ****                      angle_dead_zone);
 111:App/Src/motor_control.c ****         } 
 112:App/Src/motor_control.c ****         // 下电机参数
 113:App/Src/motor_control.c ****         else {
 114:App/Src/motor_control.c ****             PID_Init(&gm6020_motors[i].speed_pid, 
 115:App/Src/motor_control.c ****                      60.0f,    // Kp
 116:App/Src/motor_control.c ****                      3.3f,     // Ki
 117:App/Src/motor_control.c ****                      0.005f,   // Kd
 118:App/Src/motor_control.c ****                      GM6020_MAX_CURRENT, 
 119:App/Src/motor_control.c ****                      5000.0f,  // 积分限幅
 120:App/Src/motor_control.c ****                      0.0f);    // 无死区
 121:App/Src/motor_control.c ****             
 122:App/Src/motor_control.c ****             PID_Init(&gm6020_motors[i].angle_pid, 
 123:App/Src/motor_control.c ****                      5.0f,     // Kp
 124:App/Src/motor_control.c ****                      0.0f,     // Ki
 125:App/Src/motor_control.c ****                      0.0f,     // Kd
 126:App/Src/motor_control.c ****                      GM6020_MAX_SPEED, 
 127:App/Src/motor_control.c ****                      0.0f,     // MaxIOut
 128:App/Src/motor_control.c ****                      0.0f);    // 无死区
ARM GAS  C:\Users\wxwsyzh\AppData\Local\Temp\ccazXLng.s 			page 12


 129:App/Src/motor_control.c ****         }
 130:App/Src/motor_control.c ****         
 131:App/Src/motor_control.c ****         // 清除PID状态
 132:App/Src/motor_control.c ****         PID_Clear(&gm6020_motors[i].speed_pid);
 473              		.loc 1 132 9 view .LVU116
 474 0066 6501     		lsls	r5, r4, #5
 475 0068 C4EB4413 		rsb	r3, r4, r4, lsl #5
 476 006c D800     		lsls	r0, r3, #3
 477 006e 1830     		adds	r0, r0, #24
 478 0070 314E     		ldr	r6, .L41+24
 479 0072 3044     		add	r0, r0, r6
 480 0074 FFF7FEFF 		bl	PID_Clear
 481              	.LVL29:
 133:App/Src/motor_control.c ****         PID_Clear(&gm6020_motors[i].angle_pid);
 482              		.loc 1 133 9 view .LVU117
 483 0078 2B1B     		subs	r3, r5, r4
 484 007a D800     		lsls	r0, r3, #3
 485 007c 5830     		adds	r0, r0, #88
 486 007e 3044     		add	r0, r0, r6
 487 0080 0430     		adds	r0, r0, #4
 488 0082 FFF7FEFF 		bl	PID_Clear
 489              	.LVL30:
 490              	.LBE3:
  74:App/Src/motor_control.c ****         gm6020_motors[i].id = i + 1;
 491              		.loc 1 74 29 discriminator 2 view .LVU118
 492 0086 0134     		adds	r4, r4, #1
 493              	.LVL31:
 494              	.L34:
  74:App/Src/motor_control.c ****         gm6020_motors[i].id = i + 1;
 495              		.loc 1 74 23 discriminator 1 view .LVU119
 496 0088 032C     		cmp	r4, #3
 497 008a 46DC     		bgt	.L39
 498              	.LBB4:
  75:App/Src/motor_control.c ****         gm6020_motors[i].mode = MOTOR_MODE_CURRENT_SPEED;
 499              		.loc 1 75 9 view .LVU120
  75:App/Src/motor_control.c ****         gm6020_motors[i].mode = MOTOR_MODE_CURRENT_SPEED;
 500              		.loc 1 75 33 is_stmt 0 view .LVU121
 501 008c 611C     		adds	r1, r4, #1
  75:App/Src/motor_control.c ****         gm6020_motors[i].mode = MOTOR_MODE_CURRENT_SPEED;
 502              		.loc 1 75 29 view .LVU122
 503 008e 2A48     		ldr	r0, .L41+24
 504 0090 C4EB4413 		rsb	r3, r4, r4, lsl #5
 505 0094 DA00     		lsls	r2, r3, #3
 506 0096 8318     		adds	r3, r0, r2
 507 0098 8154     		strb	r1, [r0, r2]
  76:App/Src/motor_control.c ****         gm6020_motors[i].target_val = 0;
 508              		.loc 1 76 9 is_stmt 1 view .LVU123
  76:App/Src/motor_control.c ****         gm6020_motors[i].target_val = 0;
 509              		.loc 1 76 31 is_stmt 0 view .LVU124
 510 009a 0122     		movs	r2, #1
 511 009c 5A70     		strb	r2, [r3, #1]
  77:App/Src/motor_control.c ****         gm6020_motors[i].round_cnt = 0;
 512              		.loc 1 77 9 is_stmt 1 view .LVU125
  77:App/Src/motor_control.c ****         gm6020_motors[i].round_cnt = 0;
 513              		.loc 1 77 37 is_stmt 0 view .LVU126
 514 009e 0022     		movs	r2, #0
 515 00a0 5A61     		str	r2, [r3, #20]	@ float
ARM GAS  C:\Users\wxwsyzh\AppData\Local\Temp\ccazXLng.s 			page 13


  78:App/Src/motor_control.c ****         gm6020_motors[i].is_stalled = 0;
 516              		.loc 1 78 9 is_stmt 1 view .LVU127
  78:App/Src/motor_control.c ****         gm6020_motors[i].is_stalled = 0;
 517              		.loc 1 78 36 is_stmt 0 view .LVU128
 518 00a2 0022     		movs	r2, #0
 519 00a4 DA60     		str	r2, [r3, #12]
  79:App/Src/motor_control.c ****         gm6020_motors[i].last_ecd = 0;
 520              		.loc 1 79 9 is_stmt 1 view .LVU129
  79:App/Src/motor_control.c ****         gm6020_motors[i].last_ecd = 0;
 521              		.loc 1 79 37 is_stmt 0 view .LVU130
 522 00a6 83F8EC20 		strb	r2, [r3, #236]
  80:App/Src/motor_control.c ****         gm6020_motors[i].feedforward = 0;
 523              		.loc 1 80 9 is_stmt 1 view .LVU131
  80:App/Src/motor_control.c ****         gm6020_motors[i].feedforward = 0;
 524              		.loc 1 80 35 is_stmt 0 view .LVU132
 525 00aa 9A80     		strh	r2, [r3, #4]	@ movhi
  81:App/Src/motor_control.c ****         gm6020_motors[i].horizon_ecd = 4096;
 526              		.loc 1 81 9 is_stmt 1 view .LVU133
  81:App/Src/motor_control.c ****         gm6020_motors[i].horizon_ecd = 4096;
 527              		.loc 1 81 38 is_stmt 0 view .LVU134
 528 00ac A3F8F420 		strh	r2, [r3, #244]	@ movhi
  82:App/Src/motor_control.c ****         
 529              		.loc 1 82 9 is_stmt 1 view .LVU135
  82:App/Src/motor_control.c ****         
 530              		.loc 1 82 38 is_stmt 0 view .LVU136
 531 00b0 4FF48052 		mov	r2, #4096
 532 00b4 A3F8EE20 		strh	r2, [r3, #238]	@ movhi
  85:App/Src/motor_control.c ****             gm6020_motors[i].gravity_gain = 0.0f;
 533              		.loc 1 85 9 is_stmt 1 view .LVU137
  85:App/Src/motor_control.c ****             gm6020_motors[i].gravity_gain = 0.0f;
 534              		.loc 1 85 12 is_stmt 0 view .LVU138
 535 00b8 032C     		cmp	r4, #3
 536 00ba A6D0     		beq	.L40
  88:App/Src/motor_control.c ****         }
 537              		.loc 1 88 13 is_stmt 1 view .LVU139
  88:App/Src/motor_control.c ****         }
 538              		.loc 1 88 43 is_stmt 0 view .LVU140
 539 00bc 1E4E     		ldr	r6, .L41+24
 540 00be 6501     		lsls	r5, r4, #5
 541 00c0 C4EB4412 		rsb	r2, r4, r4, lsl #5
 542 00c4 D300     		lsls	r3, r2, #3
 543 00c6 3344     		add	r3, r3, r6
 544 00c8 9FED158A 		vldr.32	s16, .L41
 545 00cc 83ED3C8A 		vstr.32	s16, [r3, #240]
  91:App/Src/motor_control.c ****         float angle_dead_zone = 0.5f; 
 546              		.loc 1 91 9 is_stmt 1 view .LVU141
 547              	.LVL32:
  92:App/Src/motor_control.c ****         
 548              		.loc 1 92 9 view .LVU142
  95:App/Src/motor_control.c ****             PID_Init(&gm6020_motors[i].speed_pid, 
 549              		.loc 1 95 9 view .LVU143
 114:App/Src/motor_control.c ****                      60.0f,    // Kp
 550              		.loc 1 114 13 view .LVU144
 551 00d0 D000     		lsls	r0, r2, #3
 552 00d2 1830     		adds	r0, r0, #24
 553 00d4 F0EE482A 		vmov.f32	s5, s16
 554 00d8 9FED122A 		vldr.32	s4, .L41+4
ARM GAS  C:\Users\wxwsyzh\AppData\Local\Temp\ccazXLng.s 			page 14


 555 00dc DFED121A 		vldr.32	s3, .L41+8
 556 00e0 9FED161A 		vldr.32	s2, .L41+28
 557 00e4 DFED160A 		vldr.32	s1, .L41+32
 558 00e8 9FED160A 		vldr.32	s0, .L41+36
 559 00ec 3044     		add	r0, r0, r6
 560 00ee FFF7FEFF 		bl	PID_Init
 561              	.LVL33:
 122:App/Src/motor_control.c ****                      5.0f,     // Kp
 562              		.loc 1 122 13 view .LVU145
 563 00f2 2B1B     		subs	r3, r5, r4
 564 00f4 D800     		lsls	r0, r3, #3
 565 00f6 5830     		adds	r0, r0, #88
 566 00f8 3044     		add	r0, r0, r6
 567 00fa F0EE482A 		vmov.f32	s5, s16
 568 00fe B0EE482A 		vmov.f32	s4, s16
 569 0102 DFED111A 		vldr.32	s3, .L41+40
 570 0106 B0EE481A 		vmov.f32	s2, s16
 571 010a F0EE480A 		vmov.f32	s1, s16
 572 010e B1EE040A 		vmov.f32	s0, #5.0e+0
 573 0112 0430     		adds	r0, r0, #4
 574 0114 FFF7FEFF 		bl	PID_Init
 575              	.LVL34:
 576 0118 A5E7     		b	.L36
 577              	.LVL35:
 578              	.L39:
 122:App/Src/motor_control.c ****                      5.0f,     // Kp
 579              		.loc 1 122 13 is_stmt 0 view .LVU146
 580              	.LBE4:
 581              	.LBE2:
 134:App/Src/motor_control.c ****     }
 135:App/Src/motor_control.c **** }
 582              		.loc 1 135 1 view .LVU147
 583 011a BDEC028B 		vldm	sp!, {d8}
 584              	.LCFI6:
 585              		.cfi_restore 80
 586              		.cfi_restore 81
 587              		.cfi_def_cfa_offset 16
 588 011e 70BD     		pop	{r4, r5, r6, pc}
 589              	.LVL36:
 590              	.L42:
 591              		.loc 1 135 1 view .LVU148
 592              		.align	2
 593              	.L41:
 594 0120 00000000 		.word	0
 595 0124 00409C45 		.word	1167867904
 596 0128 00008046 		.word	1182793728
 597 012c CDCCCC3D 		.word	1036831949
 598 0130 00000C43 		.word	1124859904
 599 0134 0000C842 		.word	1120403456
 600 0138 00000000 		.word	gm6020_motors
 601 013c 0AD7A33B 		.word	1000593162
 602 0140 33335340 		.word	1079194419
 603 0144 00007042 		.word	1114636288
 604 0148 0000A043 		.word	1134559232
 605              		.cfi_endproc
 606              	.LFE139:
 608              		.section	.text.Motor_Update_Feedback,"ax",%progbits
ARM GAS  C:\Users\wxwsyzh\AppData\Local\Temp\ccazXLng.s 			page 15


 609              		.align	1
 610              		.global	Motor_Update_Feedback
 611              		.syntax unified
 612              		.thumb
 613              		.thumb_func
 615              	Motor_Update_Feedback:
 616              	.LVL37:
 617              	.LFB140:
 136:App/Src/motor_control.c **** 
 137:App/Src/motor_control.c **** void Motor_Update_Feedback(uint8_t id, uint8_t *rx_data) {
 618              		.loc 1 137 58 is_stmt 1 view -0
 619              		.cfi_startproc
 620              		@ args = 0, pretend = 0, frame = 0
 621              		@ frame_needed = 0, uses_anonymous_args = 0
 622              		.loc 1 137 58 is_stmt 0 view .LVU150
 623 0000 08B5     		push	{r3, lr}
 624              	.LCFI7:
 625              		.cfi_def_cfa_offset 8
 626              		.cfi_offset 3, -8
 627              		.cfi_offset 14, -4
 138:App/Src/motor_control.c ****     if (id < 1 || id > 4) return;
 628              		.loc 1 138 5 is_stmt 1 view .LVU151
 629              		.loc 1 138 16 is_stmt 0 view .LVU152
 630 0002 431E     		subs	r3, r0, #1
 631 0004 DBB2     		uxtb	r3, r3
 632              		.loc 1 138 8 view .LVU153
 633 0006 032B     		cmp	r3, #3
 634 0008 00D9     		bls	.L46
 635              	.LVL38:
 636              	.L43:
 139:App/Src/motor_control.c ****     GM6020_TypeDef *motor = &gm6020_motors[id - 1];
 140:App/Src/motor_control.c ****     
 141:App/Src/motor_control.c ****     motor->ecd_raw = (rx_data[0] << 8) | rx_data[1];
 142:App/Src/motor_control.c ****     motor->speed_rpm = (int16_t)((rx_data[2] << 8) | rx_data[3]);
 143:App/Src/motor_control.c ****     motor->current_raw = (int16_t)((rx_data[4] << 8) | rx_data[5]);
 144:App/Src/motor_control.c ****     motor->temp = rx_data[6];
 145:App/Src/motor_control.c ****     
 146:App/Src/motor_control.c ****     Motor_Process_Angle(motor);
 147:App/Src/motor_control.c **** }
 637              		.loc 1 147 1 view .LVU154
 638 000a 08BD     		pop	{r3, pc}
 639              	.LVL39:
 640              	.L46:
 139:App/Src/motor_control.c ****     GM6020_TypeDef *motor = &gm6020_motors[id - 1];
 641              		.loc 1 139 5 is_stmt 1 view .LVU155
 139:App/Src/motor_control.c ****     GM6020_TypeDef *motor = &gm6020_motors[id - 1];
 642              		.loc 1 139 47 is_stmt 0 view .LVU156
 643 000c 431E     		subs	r3, r0, #1
 139:App/Src/motor_control.c ****     GM6020_TypeDef *motor = &gm6020_motors[id - 1];
 644              		.loc 1 139 21 view .LVU157
 645 000e C3EB4310 		rsb	r0, r3, r3, lsl #5
 646              	.LVL40:
 139:App/Src/motor_control.c ****     GM6020_TypeDef *motor = &gm6020_motors[id - 1];
 647              		.loc 1 139 21 view .LVU158
 648 0012 104A     		ldr	r2, .L47
 649 0014 02EBC000 		add	r0, r2, r0, lsl #3
 650              	.LVL41:
ARM GAS  C:\Users\wxwsyzh\AppData\Local\Temp\ccazXLng.s 			page 16


 141:App/Src/motor_control.c ****     motor->speed_rpm = (int16_t)((rx_data[2] << 8) | rx_data[3]);
 651              		.loc 1 141 5 is_stmt 1 view .LVU159
 141:App/Src/motor_control.c ****     motor->speed_rpm = (int16_t)((rx_data[2] << 8) | rx_data[3]);
 652              		.loc 1 141 30 is_stmt 0 view .LVU160
 653 0018 91F800E0 		ldrb	lr, [r1]	@ zero_extendqisi2
 141:App/Src/motor_control.c ****     motor->speed_rpm = (int16_t)((rx_data[2] << 8) | rx_data[3]);
 654              		.loc 1 141 49 view .LVU161
 655 001c 91F801C0 		ldrb	ip, [r1, #1]	@ zero_extendqisi2
 141:App/Src/motor_control.c ****     motor->speed_rpm = (int16_t)((rx_data[2] << 8) | rx_data[3]);
 656              		.loc 1 141 40 view .LVU162
 657 0020 4CEA0E2C 		orr	ip, ip, lr, lsl #8
 141:App/Src/motor_control.c ****     motor->speed_rpm = (int16_t)((rx_data[2] << 8) | rx_data[3]);
 658              		.loc 1 141 20 view .LVU163
 659 0024 A0F802C0 		strh	ip, [r0, #2]	@ movhi
 142:App/Src/motor_control.c ****     motor->current_raw = (int16_t)((rx_data[4] << 8) | rx_data[5]);
 660              		.loc 1 142 5 is_stmt 1 view .LVU164
 142:App/Src/motor_control.c ****     motor->current_raw = (int16_t)((rx_data[4] << 8) | rx_data[5]);
 661              		.loc 1 142 42 is_stmt 0 view .LVU165
 662 0028 91F802E0 		ldrb	lr, [r1, #2]	@ zero_extendqisi2
 142:App/Src/motor_control.c ****     motor->current_raw = (int16_t)((rx_data[4] << 8) | rx_data[5]);
 663              		.loc 1 142 61 view .LVU166
 664 002c 91F803C0 		ldrb	ip, [r1, #3]	@ zero_extendqisi2
 142:App/Src/motor_control.c ****     motor->current_raw = (int16_t)((rx_data[4] << 8) | rx_data[5]);
 665              		.loc 1 142 24 view .LVU167
 666 0030 4CEA0E2C 		orr	ip, ip, lr, lsl #8
 142:App/Src/motor_control.c ****     motor->current_raw = (int16_t)((rx_data[4] << 8) | rx_data[5]);
 667              		.loc 1 142 22 view .LVU168
 668 0034 A0F806C0 		strh	ip, [r0, #6]	@ movhi
 143:App/Src/motor_control.c ****     motor->temp = rx_data[6];
 669              		.loc 1 143 5 is_stmt 1 view .LVU169
 143:App/Src/motor_control.c ****     motor->temp = rx_data[6];
 670              		.loc 1 143 44 is_stmt 0 view .LVU170
 671 0038 91F804E0 		ldrb	lr, [r1, #4]	@ zero_extendqisi2
 143:App/Src/motor_control.c ****     motor->temp = rx_data[6];
 672              		.loc 1 143 63 view .LVU171
 673 003c 91F805C0 		ldrb	ip, [r1, #5]	@ zero_extendqisi2
 143:App/Src/motor_control.c ****     motor->temp = rx_data[6];
 674              		.loc 1 143 26 view .LVU172
 675 0040 4CEA0E2C 		orr	ip, ip, lr, lsl #8
 143:App/Src/motor_control.c ****     motor->temp = rx_data[6];
 676              		.loc 1 143 24 view .LVU173
 677 0044 A0F808C0 		strh	ip, [r0, #8]	@ movhi
 144:App/Src/motor_control.c ****     
 678              		.loc 1 144 5 is_stmt 1 view .LVU174
 144:App/Src/motor_control.c ****     
 679              		.loc 1 144 17 is_stmt 0 view .LVU175
 680 0048 8979     		ldrb	r1, [r1, #6]	@ zero_extendqisi2
 681              	.LVL42:
 144:App/Src/motor_control.c ****     
 682              		.loc 1 144 17 view .LVU176
 683 004a 8172     		strb	r1, [r0, #10]
 146:App/Src/motor_control.c **** }
 684              		.loc 1 146 5 is_stmt 1 view .LVU177
 685 004c FFF7FEFF 		bl	Motor_Process_Angle
 686              	.LVL43:
 146:App/Src/motor_control.c **** }
 687              		.loc 1 146 5 is_stmt 0 view .LVU178
ARM GAS  C:\Users\wxwsyzh\AppData\Local\Temp\ccazXLng.s 			page 17


 688 0050 DBE7     		b	.L43
 689              	.L48:
 690 0052 00BF     		.align	2
 691              	.L47:
 692 0054 00000000 		.word	gm6020_motors
 693              		.cfi_endproc
 694              	.LFE140:
 696              		.section	.text.Motor_Set_Target,"ax",%progbits
 697              		.align	1
 698              		.global	Motor_Set_Target
 699              		.syntax unified
 700              		.thumb
 701              		.thumb_func
 703              	Motor_Set_Target:
 704              	.LVL44:
 705              	.LFB141:
 148:App/Src/motor_control.c **** 
 149:App/Src/motor_control.c **** void Motor_Set_Target(uint8_t id, Motor_Mode_e mode, float target) {
 706              		.loc 1 149 68 is_stmt 1 view -0
 707              		.cfi_startproc
 708              		@ args = 0, pretend = 0, frame = 0
 709              		@ frame_needed = 0, uses_anonymous_args = 0
 150:App/Src/motor_control.c ****     if (id < 1 || id > 4) return;
 710              		.loc 1 150 5 view .LVU180
 711              		.loc 1 150 16 is_stmt 0 view .LVU181
 712 0000 431E     		subs	r3, r0, #1
 713 0002 DBB2     		uxtb	r3, r3
 714              		.loc 1 150 8 view .LVU182
 715 0004 032B     		cmp	r3, #3
 716 0006 24D8     		bhi	.L52
 149:App/Src/motor_control.c ****     if (id < 1 || id > 4) return;
 717              		.loc 1 149 68 view .LVU183
 718 0008 70B5     		push	{r4, r5, r6, lr}
 719              	.LCFI8:
 720              		.cfi_def_cfa_offset 16
 721              		.cfi_offset 4, -16
 722              		.cfi_offset 5, -12
 723              		.cfi_offset 6, -8
 724              		.cfi_offset 14, -4
 151:App/Src/motor_control.c ****     GM6020_TypeDef *motor = &gm6020_motors[id - 1];
 725              		.loc 1 151 5 is_stmt 1 view .LVU184
 726              		.loc 1 151 47 is_stmt 0 view .LVU185
 727 000a 441E     		subs	r4, r0, #1
 728              	.LVL45:
 152:App/Src/motor_control.c ****     
 153:App/Src/motor_control.c ****     // 启用堵转保护
 154:App/Src/motor_control.c ****     if (motor->is_stalled) {
 729              		.loc 1 154 5 is_stmt 1 view .LVU186
 730              		.loc 1 154 14 is_stmt 0 view .LVU187
 731 000c C4EB4412 		rsb	r2, r4, r4, lsl #5
 732 0010 104B     		ldr	r3, .L56
 733 0012 03EBC203 		add	r3, r3, r2, lsl #3
 734 0016 93F8EC30 		ldrb	r3, [r3, #236]	@ zero_extendqisi2
 735              		.loc 1 154 8 view .LVU188
 736 001a 43B9     		cbnz	r3, .L49
 155:App/Src/motor_control.c ****         return;
 156:App/Src/motor_control.c ****     }
ARM GAS  C:\Users\wxwsyzh\AppData\Local\Temp\ccazXLng.s 			page 18


 157:App/Src/motor_control.c ****     
 158:App/Src/motor_control.c ****     Motor_Mode_e old_mode = motor->mode;
 737              		.loc 1 158 5 is_stmt 1 view .LVU189
 738              		.loc 1 158 18 is_stmt 0 view .LVU190
 739 001c 0D4B     		ldr	r3, .L56
 740 001e 03EBC203 		add	r3, r3, r2, lsl #3
 741 0022 5A78     		ldrb	r2, [r3, #1]	@ zero_extendqisi2
 742              	.LVL46:
 159:App/Src/motor_control.c ****     motor->mode = mode;
 743              		.loc 1 159 5 is_stmt 1 view .LVU191
 744              		.loc 1 159 17 is_stmt 0 view .LVU192
 745 0024 5970     		strb	r1, [r3, #1]
 746              	.LVL47:
 160:App/Src/motor_control.c ****     motor->target_val = target;
 747              		.loc 1 160 5 is_stmt 1 view .LVU193
 748              		.loc 1 160 23 is_stmt 0 view .LVU194
 749 0026 83ED050A 		vstr.32	s0, [r3, #20]
 161:App/Src/motor_control.c ****     
 162:App/Src/motor_control.c ****     // 切换模式时清除 PID 积分
 163:App/Src/motor_control.c ****     if (old_mode != mode) {
 750              		.loc 1 163 5 is_stmt 1 view .LVU195
 751              		.loc 1 163 8 is_stmt 0 view .LVU196
 752 002a 8A42     		cmp	r2, r1
 753 002c 00D1     		bne	.L55
 754              	.LVL48:
 755              	.L49:
 164:App/Src/motor_control.c ****         PID_Clear(&motor->speed_pid);
 165:App/Src/motor_control.c ****         PID_Clear(&motor->angle_pid);
 166:App/Src/motor_control.c ****     }
 167:App/Src/motor_control.c **** }
 756              		.loc 1 167 1 view .LVU197
 757 002e 70BD     		pop	{r4, r5, r6, pc}
 758              	.LVL49:
 759              	.L55:
 164:App/Src/motor_control.c ****         PID_Clear(&motor->speed_pid);
 760              		.loc 1 164 9 is_stmt 1 view .LVU198
 761 0030 6501     		lsls	r5, r4, #5
 762 0032 C4EB4410 		rsb	r0, r4, r4, lsl #5
 763              	.LVL50:
 164:App/Src/motor_control.c ****         PID_Clear(&motor->speed_pid);
 764              		.loc 1 164 9 is_stmt 0 view .LVU199
 765 0036 C000     		lsls	r0, r0, #3
 766 0038 1830     		adds	r0, r0, #24
 767 003a 064E     		ldr	r6, .L56
 768 003c 3044     		add	r0, r0, r6
 769 003e FFF7FEFF 		bl	PID_Clear
 770              	.LVL51:
 165:App/Src/motor_control.c ****     }
 771              		.loc 1 165 9 is_stmt 1 view .LVU200
 772 0042 281B     		subs	r0, r5, r4
 773 0044 C000     		lsls	r0, r0, #3
 774 0046 5830     		adds	r0, r0, #88
 775 0048 3044     		add	r0, r0, r6
 776 004a 0430     		adds	r0, r0, #4
 777 004c FFF7FEFF 		bl	PID_Clear
 778              	.LVL52:
 779 0050 EDE7     		b	.L49
ARM GAS  C:\Users\wxwsyzh\AppData\Local\Temp\ccazXLng.s 			page 19


 780              	.LVL53:
 781              	.L52:
 782              	.LCFI9:
 783              		.cfi_def_cfa_offset 0
 784              		.cfi_restore 4
 785              		.cfi_restore 5
 786              		.cfi_restore 6
 787              		.cfi_restore 14
 165:App/Src/motor_control.c ****     }
 788              		.loc 1 165 9 is_stmt 0 view .LVU201
 789 0052 7047     		bx	lr
 790              	.L57:
 791              		.align	2
 792              	.L56:
 793 0054 00000000 		.word	gm6020_motors
 794              		.cfi_endproc
 795              	.LFE141:
 797              		.section	.text.Motor_Control_Loop,"ax",%progbits
 798              		.align	1
 799              		.global	Motor_Control_Loop
 800              		.syntax unified
 801              		.thumb
 802              		.thumb_func
 804              	Motor_Control_Loop:
 805              	.LFB142:
 168:App/Src/motor_control.c **** 
 169:App/Src/motor_control.c **** void Motor_Control_Loop(void) {
 806              		.loc 1 169 31 is_stmt 1 view -0
 807              		.cfi_startproc
 808              		@ args = 0, pretend = 0, frame = 0
 809              		@ frame_needed = 0, uses_anonymous_args = 0
 810 0000 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 811              	.LCFI10:
 812              		.cfi_def_cfa_offset 24
 813              		.cfi_offset 4, -24
 814              		.cfi_offset 5, -20
 815              		.cfi_offset 6, -16
 816              		.cfi_offset 7, -12
 817              		.cfi_offset 8, -8
 818              		.cfi_offset 14, -4
 819 0004 2DED028B 		vpush.64	{d8}
 820              	.LCFI11:
 821              		.cfi_def_cfa_offset 32
 822              		.cfi_offset 80, -32
 823              		.cfi_offset 81, -28
 170:App/Src/motor_control.c ****     for (int i = 0; i < 4; i++) {
 824              		.loc 1 170 5 view .LVU203
 825              	.LBB5:
 826              		.loc 1 170 10 view .LVU204
 827              	.LVL54:
 828              		.loc 1 170 14 is_stmt 0 view .LVU205
 829 0008 0024     		movs	r4, #0
 830              		.loc 1 170 5 view .LVU206
 831 000a 46E0     		b	.L59
 832              	.LVL55:
 833              	.L60:
 834              	.LBB6:
ARM GAS  C:\Users\wxwsyzh\AppData\Local\Temp\ccazXLng.s 			page 20


 171:App/Src/motor_control.c ****         GM6020_TypeDef *motor = &gm6020_motors[i];
 172:App/Src/motor_control.c ****         float speed_target = 0;
 173:App/Src/motor_control.c ****         float current_target = 0;
 174:App/Src/motor_control.c ****         
 175:App/Src/motor_control.c ****         // 堵转保护
 176:App/Src/motor_control.c ****         if (motor->is_stalled || motor->mode == MOTOR_MODE_STOP) {
 177:App/Src/motor_control.c ****             motor->output_current = 0;
 835              		.loc 1 177 13 is_stmt 1 view .LVU207
 836              		.loc 1 177 35 is_stmt 0 view .LVU208
 837 000c C4EB4412 		rsb	r2, r4, r4, lsl #5
 838 0010 4D4B     		ldr	r3, .L72
 839 0012 03EBC203 		add	r3, r3, r2, lsl #3
 840 0016 0022     		movs	r2, #0
 841 0018 A3F8E420 		strh	r2, [r3, #228]	@ movhi
 178:App/Src/motor_control.c ****             motor_current_send_buf[i] = 0;
 842              		.loc 1 178 13 is_stmt 1 view .LVU209
 843              		.loc 1 178 39 is_stmt 0 view .LVU210
 844 001c 4B4B     		ldr	r3, .L72+4
 845 001e 23F81420 		strh	r2, [r3, r4, lsl #1]	@ movhi
 179:App/Src/motor_control.c ****             continue;
 846              		.loc 1 179 13 is_stmt 1 view .LVU211
 847 0022 39E0     		b	.L62
 848              	.L63:
 180:App/Src/motor_control.c ****         }
 181:App/Src/motor_control.c **** 
 182:App/Src/motor_control.c ****         switch (motor->mode) {
 183:App/Src/motor_control.c ****             case MOTOR_MODE_CURRENT_OPEN:
 184:App/Src/motor_control.c ****                 current_target = motor->target_val;
 185:App/Src/motor_control.c ****                 break;
 186:App/Src/motor_control.c ****                 
 187:App/Src/motor_control.c ****             case MOTOR_MODE_CURRENT_SPEED:
 188:App/Src/motor_control.c ****                 current_target = PID_Calc(&motor->speed_pid, motor->target_val, motor->speed_rpm);
 849              		.loc 1 188 17 view .LVU212
 850              		.loc 1 188 86 is_stmt 0 view .LVU213
 851 0024 4848     		ldr	r0, .L72
 852 0026 C4EB4412 		rsb	r2, r4, r4, lsl #5
 853 002a 00EBC202 		add	r2, r0, r2, lsl #3
 854 002e B2F90630 		ldrsh	r3, [r2, #6]
 855 0032 00EE903A 		vmov	s1, r3	@ int
 856              		.loc 1 188 34 view .LVU214
 857 0036 C4EB4413 		rsb	r3, r4, r4, lsl #5
 858 003a DB00     		lsls	r3, r3, #3
 859 003c 1833     		adds	r3, r3, #24
 860 003e F8EEE00A 		vcvt.f32.s32	s1, s1
 861 0042 92ED050A 		vldr.32	s0, [r2, #20]
 862 0046 1844     		add	r0, r0, r3
 863 0048 FFF7FEFF 		bl	PID_Calc
 864              	.LVL56:
 865 004c B0EE408A 		vmov.f32	s16, s0
 866              	.LVL57:
 189:App/Src/motor_control.c ****                 break;
 867              		.loc 1 189 17 is_stmt 1 view .LVU215
 868              	.L65:
 190:App/Src/motor_control.c ****                 
 191:App/Src/motor_control.c ****             case MOTOR_MODE_CURRENT_POS_CASCADE:
 192:App/Src/motor_control.c ****                 speed_target = PID_Calc(&motor->angle_pid, motor->target_val, motor->total_angle);
 193:App/Src/motor_control.c ****                 current_target = PID_Calc(&motor->speed_pid, speed_target, motor->speed_rpm);
ARM GAS  C:\Users\wxwsyzh\AppData\Local\Temp\ccazXLng.s 			page 21


 194:App/Src/motor_control.c ****                 break;
 195:App/Src/motor_control.c ****                 
 196:App/Src/motor_control.c ****             default:
 197:App/Src/motor_control.c ****                 current_target = 0;
 198:App/Src/motor_control.c ****                 break;
 199:App/Src/motor_control.c ****         }
 200:App/Src/motor_control.c **** 
 201:App/Src/motor_control.c ****         if (motor->id != 4 && (motor->mode == MOTOR_MODE_CURRENT_SPEED || 
 869              		.loc 1 201 9 view .LVU216
 870              		.loc 1 201 18 is_stmt 0 view .LVU217
 871 0050 C4EB4413 		rsb	r3, r4, r4, lsl #5
 872 0054 3C4A     		ldr	r2, .L72
 873 0056 12F83330 		ldrb	r3, [r2, r3, lsl #3]	@ zero_extendqisi2
 874              		.loc 1 201 12 view .LVU218
 875 005a 042B     		cmp	r3, #4
 876 005c 09D0     		beq	.L66
 877              		.loc 1 201 37 discriminator 1 view .LVU219
 878 005e C4EB4412 		rsb	r2, r4, r4, lsl #5
 879 0062 394B     		ldr	r3, .L72
 880 0064 03EBC203 		add	r3, r3, r2, lsl #3
 881 0068 5B78     		ldrb	r3, [r3, #1]	@ zero_extendqisi2
 882              		.loc 1 201 72 discriminator 1 view .LVU220
 883 006a 013B     		subs	r3, r3, #1
 884 006c DBB2     		uxtb	r3, r3
 885              		.loc 1 201 28 discriminator 1 view .LVU221
 886 006e 012B     		cmp	r3, #1
 887 0070 52D9     		bls	.L70
 888              	.L66:
 202:App/Src/motor_control.c ****             motor->mode == MOTOR_MODE_CURRENT_POS_CASCADE)) {
 203:App/Src/motor_control.c ****             
 204:App/Src/motor_control.c ****             motor->feedforward = Motor_Calc_Gravity_FF(motor);
 205:App/Src/motor_control.c ****             current_target += motor->feedforward;
 206:App/Src/motor_control.c ****         }
 207:App/Src/motor_control.c **** 
 208:App/Src/motor_control.c ****         // 限制电流范围
 209:App/Src/motor_control.c ****         motor->output_current = limit_current(current_target);
 889              		.loc 1 209 9 is_stmt 1 view .LVU222
 890              		.loc 1 209 33 is_stmt 0 view .LVU223
 891 0072 B0EE480A 		vmov.f32	s0, s16
 892 0076 FFF7FEFF 		bl	limit_current
 893              	.LVL58:
 894              		.loc 1 209 31 discriminator 1 view .LVU224
 895 007a C4EB4413 		rsb	r3, r4, r4, lsl #5
 896 007e 324E     		ldr	r6, .L72
 897 0080 06EBC306 		add	r6, r6, r3, lsl #3
 898 0084 A6F8E400 		strh	r0, [r6, #228]	@ movhi
 210:App/Src/motor_control.c ****         
 211:App/Src/motor_control.c ****         // 执行堵转检测
 212:App/Src/motor_control.c ****         Motor_Check_Stall(motor);
 899              		.loc 1 212 9 is_stmt 1 view .LVU225
 900 0088 2846     		mov	r0, r5
 901 008a FFF7FEFF 		bl	Motor_Check_Stall
 902              	.LVL59:
 213:App/Src/motor_control.c ****         
 214:App/Src/motor_control.c ****         // 填入发送缓冲区
 215:App/Src/motor_control.c ****         motor_current_send_buf[i] = motor->output_current;
 903              		.loc 1 215 9 view .LVU226
ARM GAS  C:\Users\wxwsyzh\AppData\Local\Temp\ccazXLng.s 			page 22


 904              		.loc 1 215 42 is_stmt 0 view .LVU227
 905 008e B6F9E420 		ldrsh	r2, [r6, #228]
 906              		.loc 1 215 35 view .LVU228
 907 0092 2E4B     		ldr	r3, .L72+4
 908 0094 23F81420 		strh	r2, [r3, r4, lsl #1]	@ movhi
 909              	.LVL60:
 910              	.L62:
 911              		.loc 1 215 35 view .LVU229
 912              	.LBE6:
 170:App/Src/motor_control.c ****         GM6020_TypeDef *motor = &gm6020_motors[i];
 913              		.loc 1 170 29 is_stmt 1 discriminator 2 view .LVU230
 914 0098 0134     		adds	r4, r4, #1
 915              	.LVL61:
 916              	.L59:
 170:App/Src/motor_control.c ****         GM6020_TypeDef *motor = &gm6020_motors[i];
 917              		.loc 1 170 23 discriminator 1 view .LVU231
 918 009a 032C     		cmp	r4, #3
 919 009c 4DDC     		bgt	.L71
 920              	.LBB7:
 171:App/Src/motor_control.c ****         float speed_target = 0;
 921              		.loc 1 171 9 view .LVU232
 171:App/Src/motor_control.c ****         float speed_target = 0;
 922              		.loc 1 171 25 is_stmt 0 view .LVU233
 923 009e C4EB4413 		rsb	r3, r4, r4, lsl #5
 924 00a2 294D     		ldr	r5, .L72
 925 00a4 05EBC305 		add	r5, r5, r3, lsl #3
 926              	.LVL62:
 172:App/Src/motor_control.c ****         float current_target = 0;
 927              		.loc 1 172 9 is_stmt 1 view .LVU234
 173:App/Src/motor_control.c ****         
 928              		.loc 1 173 9 view .LVU235
 176:App/Src/motor_control.c ****             motor->output_current = 0;
 929              		.loc 1 176 9 view .LVU236
 176:App/Src/motor_control.c ****             motor->output_current = 0;
 930              		.loc 1 176 18 is_stmt 0 view .LVU237
 931 00a8 95F8EC30 		ldrb	r3, [r5, #236]	@ zero_extendqisi2
 176:App/Src/motor_control.c ****             motor->output_current = 0;
 932              		.loc 1 176 12 view .LVU238
 933 00ac 002B     		cmp	r3, #0
 934 00ae ADD1     		bne	.L60
 176:App/Src/motor_control.c ****             motor->output_current = 0;
 935              		.loc 1 176 39 discriminator 2 view .LVU239
 936 00b0 6B78     		ldrb	r3, [r5, #1]	@ zero_extendqisi2
 176:App/Src/motor_control.c ****             motor->output_current = 0;
 937              		.loc 1 176 31 discriminator 2 view .LVU240
 938 00b2 032B     		cmp	r3, #3
 939 00b4 AAD0     		beq	.L60
 182:App/Src/motor_control.c ****             case MOTOR_MODE_CURRENT_OPEN:
 940              		.loc 1 182 9 is_stmt 1 view .LVU241
 941 00b6 012B     		cmp	r3, #1
 942 00b8 B4D0     		beq	.L63
 943 00ba 022B     		cmp	r3, #2
 944 00bc 08D0     		beq	.L64
 945 00be 43BB     		cbnz	r3, .L68
 184:App/Src/motor_control.c ****                 break;
 946              		.loc 1 184 17 view .LVU242
 184:App/Src/motor_control.c ****                 break;
ARM GAS  C:\Users\wxwsyzh\AppData\Local\Temp\ccazXLng.s 			page 23


 947              		.loc 1 184 32 is_stmt 0 view .LVU243
 948 00c0 C4EB4412 		rsb	r2, r4, r4, lsl #5
 949 00c4 204B     		ldr	r3, .L72
 950 00c6 03EBC203 		add	r3, r3, r2, lsl #3
 951 00ca 93ED058A 		vldr.32	s16, [r3, #20]
 952              	.LVL63:
 185:App/Src/motor_control.c ****                 
 953              		.loc 1 185 17 is_stmt 1 view .LVU244
 954 00ce BFE7     		b	.L65
 955              	.LVL64:
 956              	.L64:
 192:App/Src/motor_control.c ****                 current_target = PID_Calc(&motor->speed_pid, speed_target, motor->speed_rpm);
 957              		.loc 1 192 17 view .LVU245
 192:App/Src/motor_control.c ****                 current_target = PID_Calc(&motor->speed_pid, speed_target, motor->speed_rpm);
 958              		.loc 1 192 32 is_stmt 0 view .LVU246
 959 00d0 1D4F     		ldr	r7, .L72
 960 00d2 6601     		lsls	r6, r4, #5
 961 00d4 C4EB4418 		rsb	r8, r4, r4, lsl #5
 962 00d8 07EBC808 		add	r8, r7, r8, lsl #3
 963 00dc C4EB4410 		rsb	r0, r4, r4, lsl #5
 964 00e0 C000     		lsls	r0, r0, #3
 965 00e2 5830     		adds	r0, r0, #88
 966 00e4 3844     		add	r0, r0, r7
 967 00e6 D8ED040A 		vldr.32	s1, [r8, #16]
 968 00ea 98ED050A 		vldr.32	s0, [r8, #20]
 969 00ee 0430     		adds	r0, r0, #4
 970 00f0 FFF7FEFF 		bl	PID_Calc
 971              	.LVL65:
 193:App/Src/motor_control.c ****                 break;
 972              		.loc 1 193 17 is_stmt 1 view .LVU247
 193:App/Src/motor_control.c ****                 break;
 973              		.loc 1 193 81 is_stmt 0 view .LVU248
 974 00f4 B8F90630 		ldrsh	r3, [r8, #6]
 975 00f8 00EE903A 		vmov	s1, r3	@ int
 193:App/Src/motor_control.c ****                 break;
 976              		.loc 1 193 34 view .LVU249
 977 00fc 301B     		subs	r0, r6, r4
 978 00fe C000     		lsls	r0, r0, #3
 979 0100 1830     		adds	r0, r0, #24
 980 0102 F8EEE00A 		vcvt.f32.s32	s1, s1
 981 0106 3844     		add	r0, r0, r7
 982 0108 FFF7FEFF 		bl	PID_Calc
 983              	.LVL66:
 193:App/Src/motor_control.c ****                 break;
 984              		.loc 1 193 34 view .LVU250
 985 010c B0EE408A 		vmov.f32	s16, s0
 986              	.LVL67:
 194:App/Src/motor_control.c ****                 
 987              		.loc 1 194 17 is_stmt 1 view .LVU251
 988 0110 9EE7     		b	.L65
 989              	.LVL68:
 990              	.L68:
 182:App/Src/motor_control.c ****             case MOTOR_MODE_CURRENT_OPEN:
 991              		.loc 1 182 9 is_stmt 0 view .LVU252
 992 0112 9FED0F8A 		vldr.32	s16, .L72+8
 993 0116 9BE7     		b	.L65
 994              	.LVL69:
ARM GAS  C:\Users\wxwsyzh\AppData\Local\Temp\ccazXLng.s 			page 24


 995              	.L70:
 204:App/Src/motor_control.c ****             current_target += motor->feedforward;
 996              		.loc 1 204 13 is_stmt 1 view .LVU253
 204:App/Src/motor_control.c ****             current_target += motor->feedforward;
 997              		.loc 1 204 34 is_stmt 0 view .LVU254
 998 0118 2846     		mov	r0, r5
 999 011a FFF7FEFF 		bl	Motor_Calc_Gravity_FF
 1000              	.LVL70:
 204:App/Src/motor_control.c ****             current_target += motor->feedforward;
 1001              		.loc 1 204 32 discriminator 1 view .LVU255
 1002 011e C4EB4412 		rsb	r2, r4, r4, lsl #5
 1003 0122 094B     		ldr	r3, .L72
 1004 0124 03EBC203 		add	r3, r3, r2, lsl #3
 1005 0128 A3F8F400 		strh	r0, [r3, #244]	@ movhi
 205:App/Src/motor_control.c ****         }
 1006              		.loc 1 205 13 is_stmt 1 view .LVU256
 205:App/Src/motor_control.c ****         }
 1007              		.loc 1 205 28 is_stmt 0 view .LVU257
 1008 012c 07EE900A 		vmov	s15, r0	@ int
 1009 0130 F8EEE77A 		vcvt.f32.s32	s15, s15
 1010 0134 38EE278A 		vadd.f32	s16, s16, s15
 1011              	.LVL71:
 205:App/Src/motor_control.c ****         }
 1012              		.loc 1 205 28 view .LVU258
 1013 0138 9BE7     		b	.L66
 1014              	.LVL72:
 1015              	.L71:
 205:App/Src/motor_control.c ****         }
 1016              		.loc 1 205 28 view .LVU259
 1017              	.LBE7:
 1018              	.LBE5:
 216:App/Src/motor_control.c ****     }
 217:App/Src/motor_control.c ****     
 218:App/Src/motor_control.c ****     // ✅ 修复函数名拼写错误
 219:App/Src/motor_control.c ****     BSP_CAN_Sned_Current_Cmd(); // 注意是 'Sned' 不是 'Send'
 1019              		.loc 1 219 5 is_stmt 1 view .LVU260
 1020 013a FFF7FEFF 		bl	BSP_CAN_Sned_Current_Cmd
 1021              	.LVL73:
 220:App/Src/motor_control.c **** }
 1022              		.loc 1 220 1 is_stmt 0 view .LVU261
 1023 013e BDEC028B 		vldm	sp!, {d8}
 1024              	.LCFI12:
 1025              		.cfi_restore 80
 1026              		.cfi_restore 81
 1027              		.cfi_def_cfa_offset 24
 1028 0142 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 1029              	.LVL74:
 1030              	.L73:
 1031              		.loc 1 220 1 view .LVU262
 1032 0146 00BF     		.align	2
 1033              	.L72:
 1034 0148 00000000 		.word	gm6020_motors
 1035 014c 00000000 		.word	motor_current_send_buf
 1036 0150 00000000 		.word	0
 1037              		.cfi_endproc
 1038              	.LFE142:
 1040              		.section	.text.Motor_Set_Dual_Target,"ax",%progbits
ARM GAS  C:\Users\wxwsyzh\AppData\Local\Temp\ccazXLng.s 			page 25


 1041              		.align	1
 1042              		.global	Motor_Set_Dual_Target
 1043              		.syntax unified
 1044              		.thumb
 1045              		.thumb_func
 1047              	Motor_Set_Dual_Target:
 1048              	.LVL75:
 1049              	.LFB143:
 221:App/Src/motor_control.c **** 
 222:App/Src/motor_control.c **** void Motor_Set_Dual_Target(uint8_t id1, Motor_Mode_e mode1, float target1,
 223:App/Src/motor_control.c ****                            uint8_t id2, Motor_Mode_e mode2, float target2) {
 1050              		.loc 1 223 76 is_stmt 1 view -0
 1051              		.cfi_startproc
 1052              		@ args = 0, pretend = 0, frame = 0
 1053              		@ frame_needed = 0, uses_anonymous_args = 0
 1054              		.loc 1 223 76 is_stmt 0 view .LVU264
 1055 0000 38B5     		push	{r3, r4, r5, lr}
 1056              	.LCFI13:
 1057              		.cfi_def_cfa_offset 16
 1058              		.cfi_offset 3, -16
 1059              		.cfi_offset 4, -12
 1060              		.cfi_offset 5, -8
 1061              		.cfi_offset 14, -4
 1062 0002 2DED028B 		vpush.64	{d8}
 1063              	.LCFI14:
 1064              		.cfi_def_cfa_offset 24
 1065              		.cfi_offset 80, -24
 1066              		.cfi_offset 81, -20
 1067 0006 1446     		mov	r4, r2
 1068 0008 1D46     		mov	r5, r3
 1069 000a B0EE608A 		vmov.f32	s16, s1
 224:App/Src/motor_control.c ****     Motor_Set_Target(id1, mode1, target1);
 1070              		.loc 1 224 5 is_stmt 1 view .LVU265
 1071 000e FFF7FEFF 		bl	Motor_Set_Target
 1072              	.LVL76:
 225:App/Src/motor_control.c ****     Motor_Set_Target(id2, mode2, target2);
 1073              		.loc 1 225 5 view .LVU266
 1074 0012 B0EE480A 		vmov.f32	s0, s16
 1075 0016 2946     		mov	r1, r5
 1076 0018 2046     		mov	r0, r4
 1077 001a FFF7FEFF 		bl	Motor_Set_Target
 1078              	.LVL77:
 226:App/Src/motor_control.c **** }...
 1079              		.loc 1 226 1 is_stmt 0 view .LVU267
 1080 001e BDEC028B 		vldm	sp!, {d8}
 1081              	.LCFI15:
 1082              		.cfi_restore 80
 1083              		.cfi_restore 81
 1084              		.cfi_def_cfa_offset 16
 1085              	.LVL78:
 1086              		.loc 1 226 1 view .LVU268
 1087 0022 38BD     		pop	{r3, r4, r5, pc}
 1088              		.loc 1 226 1 view .LVU269
 1089              		.cfi_endproc
 1090              	.LFE143:
 1092              		.global	motor_current_send_buf
 1093              		.section	.bss.motor_current_send_buf,"aw",%nobits
ARM GAS  C:\Users\wxwsyzh\AppData\Local\Temp\ccazXLng.s 			page 26


 1094              		.align	2
 1097              	motor_current_send_buf:
 1098 0000 00000000 		.space	8
 1098      00000000 
 1099              		.global	gm6020_motors
 1100              		.section	.bss.gm6020_motors,"aw",%nobits
 1101              		.align	2
 1104              	gm6020_motors:
 1105 0000 00000000 		.space	992
 1105      00000000 
 1105      00000000 
 1105      00000000 
 1105      00000000 
 1106              		.text
 1107              	.Letext0:
 1108              		.file 2 "C:/msys64/mingw64/arm-none-eabi/include/machine/_default_types.h"
 1109              		.file 3 "C:/msys64/mingw64/arm-none-eabi/include/sys/_stdint.h"
 1110              		.file 4 "App/Inc/pid.h"
 1111              		.file 5 "App/Inc/motor_control.h"
 1112              		.file 6 "C:/msys64/mingw64/arm-none-eabi/include/math.h"
 1113              		.file 7 "App/Inc/can_bsp.h"
ARM GAS  C:\Users\wxwsyzh\AppData\Local\Temp\ccazXLng.s 			page 27


DEFINED SYMBOLS
                            *ABS*:00000000 motor_control.c
C:\Users\wxwsyzh\AppData\Local\Temp\ccazXLng.s:21     .text.Motor_Process_Angle:00000000 $t
C:\Users\wxwsyzh\AppData\Local\Temp\ccazXLng.s:26     .text.Motor_Process_Angle:00000000 Motor_Process_Angle
C:\Users\wxwsyzh\AppData\Local\Temp\ccazXLng.s:94     .text.Motor_Process_Angle:00000050 $d
C:\Users\wxwsyzh\AppData\Local\Temp\ccazXLng.s:100    .text.limit_current:00000000 $t
C:\Users\wxwsyzh\AppData\Local\Temp\ccazXLng.s:105    .text.limit_current:00000000 limit_current
C:\Users\wxwsyzh\AppData\Local\Temp\ccazXLng.s:146    .text.limit_current:00000034 $d
C:\Users\wxwsyzh\AppData\Local\Temp\ccazXLng.s:153    .text.Motor_Check_Stall:00000000 $t
C:\Users\wxwsyzh\AppData\Local\Temp\ccazXLng.s:158    .text.Motor_Check_Stall:00000000 Motor_Check_Stall
C:\Users\wxwsyzh\AppData\Local\Temp\ccazXLng.s:230    .text.Motor_Check_Stall:00000070 $d
C:\Users\wxwsyzh\AppData\Local\Temp\ccazXLng.s:236    .text.Motor_Calc_Gravity_FF:00000000 $t
C:\Users\wxwsyzh\AppData\Local\Temp\ccazXLng.s:241    .text.Motor_Calc_Gravity_FF:00000000 Motor_Calc_Gravity_FF
C:\Users\wxwsyzh\AppData\Local\Temp\ccazXLng.s:338    .text.Motor_Calc_Gravity_FF:0000005c $d
C:\Users\wxwsyzh\AppData\Local\Temp\ccazXLng.s:343    .text.Motor_Clear_Stall:00000000 $t
C:\Users\wxwsyzh\AppData\Local\Temp\ccazXLng.s:349    .text.Motor_Clear_Stall:00000000 Motor_Clear_Stall
C:\Users\wxwsyzh\AppData\Local\Temp\ccazXLng.s:393    .text.Motor_Clear_Stall:0000002c $d
C:\Users\wxwsyzh\AppData\Local\Temp\ccazXLng.s:1104   .bss.gm6020_motors:00000000 gm6020_motors
C:\Users\wxwsyzh\AppData\Local\Temp\ccazXLng.s:398    .text.Motor_Init_All:00000000 $t
C:\Users\wxwsyzh\AppData\Local\Temp\ccazXLng.s:404    .text.Motor_Init_All:00000000 Motor_Init_All
C:\Users\wxwsyzh\AppData\Local\Temp\ccazXLng.s:594    .text.Motor_Init_All:00000120 $d
C:\Users\wxwsyzh\AppData\Local\Temp\ccazXLng.s:609    .text.Motor_Update_Feedback:00000000 $t
C:\Users\wxwsyzh\AppData\Local\Temp\ccazXLng.s:615    .text.Motor_Update_Feedback:00000000 Motor_Update_Feedback
C:\Users\wxwsyzh\AppData\Local\Temp\ccazXLng.s:692    .text.Motor_Update_Feedback:00000054 $d
C:\Users\wxwsyzh\AppData\Local\Temp\ccazXLng.s:697    .text.Motor_Set_Target:00000000 $t
C:\Users\wxwsyzh\AppData\Local\Temp\ccazXLng.s:703    .text.Motor_Set_Target:00000000 Motor_Set_Target
C:\Users\wxwsyzh\AppData\Local\Temp\ccazXLng.s:793    .text.Motor_Set_Target:00000054 $d
C:\Users\wxwsyzh\AppData\Local\Temp\ccazXLng.s:798    .text.Motor_Control_Loop:00000000 $t
C:\Users\wxwsyzh\AppData\Local\Temp\ccazXLng.s:804    .text.Motor_Control_Loop:00000000 Motor_Control_Loop
C:\Users\wxwsyzh\AppData\Local\Temp\ccazXLng.s:1034   .text.Motor_Control_Loop:00000148 $d
C:\Users\wxwsyzh\AppData\Local\Temp\ccazXLng.s:1097   .bss.motor_current_send_buf:00000000 motor_current_send_buf
C:\Users\wxwsyzh\AppData\Local\Temp\ccazXLng.s:1041   .text.Motor_Set_Dual_Target:00000000 $t
C:\Users\wxwsyzh\AppData\Local\Temp\ccazXLng.s:1047   .text.Motor_Set_Dual_Target:00000000 Motor_Set_Dual_Target
C:\Users\wxwsyzh\AppData\Local\Temp\ccazXLng.s:1094   .bss.motor_current_send_buf:00000000 $d
C:\Users\wxwsyzh\AppData\Local\Temp\ccazXLng.s:1101   .bss.gm6020_motors:00000000 $d

UNDEFINED SYMBOLS
cosf
PID_Init
PID_Clear
PID_Calc
BSP_CAN_Sned_Current_Cmd
